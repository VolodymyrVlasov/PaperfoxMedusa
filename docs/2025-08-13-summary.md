# Підсумок робіт — 13.08.2025

---

## 1. GitHub репозиторій
- Створено репозиторій: **PaperfoxMedusa** — https://github.com/VolodymyrVlasov/PaperfoxMedusa
- Налаштовано підключення по SSH (заміна remote дозволила уникнути введення логіна/пароля при пуші).
- Додано структуру з папкою `infra/` для інфраструктурних конфігів:
  - **infra/nginx/** — шаблони конфігів для `api.paperfox.top`, `paperfox.top`, `admin.paperfox.top`.
  - **infra/pm2/** — `ecosystem.config.js` для керування процесом через PM2.
- Додано `.env` та `medusa-config.js` з актуальними налаштуваннями.
- Створено папку `apps/site/` для майбутнього фронтенд-білду та `apps/site-src/` для сирцевих файлів фронта.

---

## 2. PM2 деплой
- Встановлено `pm2` глобально.
- Виконано початкове налаштування деплою:
  - `pm2 deploy ./infra/pm2/ecosystem.config.js production`
- Виявлена проблема з невідповідністю коду на сервері (файл `medusa-config.js` не оновився).
  - Тимчасово виправлено вручну та синхронізовано з GitHub.
  - Надалі потрібно перевіряти, чи деплой затягує останні зміни.

---

## 3. Medusa API
- Підтверджено роботу авторизації.
- Статика для медіафайлів працює з коректним шляхом:
  - `/static/` через Nginx (`alias /home/deploy/apps/medusa-paperfox/medusa-paperfox/static/`).
  - Файли зберігаються у папку `static` у корені бекенду.
- Додано у `medusa-config.js` модуль `@medusajs/medusa/file` з локальним провайдером.

---

## 4. Nginx
- Оновлені конфіги для віддачі статики з бекенду.
- Підготовлені шаблони для основного домену та адмінки у `infra/nginx/`.

---

## 5. Процедура розробки (узгоджено)
1. **Локальна розробка**
   - Клонувати репозиторій.
   - Створювати окремі гілки для змін (`feature/...`).
   - Розробку фронта вести у `apps/site-src/`.
2. **Фронтенд білд**
   - Gulp збирає з `apps/site-src` → `apps/site` (це корінь для Nginx).
   - API-запити у фронті йдуть на `https://api.paperfox.top`.
3. **Деплой**
   - Злиття гілки в `main`.
   - `pm2 deploy ./infra/pm2/ecosystem.config.js production`
   - Білд фронта або на сервері, або локально перед пушем.

---

## 6. Наступні кроки
- Підготувати `gulpfile.js` та `package.json` для фронта.
- Додати збірку фронта у процес деплою.
- Протестувати повний цикл "зміна → пуш → деплой" без ручного втручання.
